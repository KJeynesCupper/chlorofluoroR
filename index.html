<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>chlorofluroR: In-house package to process CF imaging data • chlorofluoroR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="chlorofluroR: In-house package to process CF imaging data">
<meta name="description" content="Data processing and plotting of FvFm and PSII.">
<meta property="og:description" content="Data processing and plotting of FvFm and PSII.">
<meta property="og:image" content="https://kjeynescupper.github.io/chlorofluoroR/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">chlorofluoroR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/KJeynesCupper/chlorofluoroR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="chlorofluoror-">chlorofluoroR <a class="anchor" aria-label="anchor" href="#chlorofluoror-"></a>
</h1>
</div>
<p>An <code>R</code> package for in-house analysis of chlorophyll fluorescence data from FluorCam FC800-331 and FluorCam 7 Software. Based on wet-lab <a href="https://www.protocols.io/view/non-photochemical-quenching-npq-relaxation-analysi-eq2lyw7mmvx9/v1" class="external-link">protocol</a> from Long Lab. This package was compiled primarily to aid plant selection, hence, it not only plots the CF results but overlaps them with copy number data and herbicide selection (ie. BASTA) results.</p>
<p><br></p>
</div>
<div class="section level1">
<h1 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a>
</h1>
<p>Katie Jeynes-Cupper, University of Illinois Urbana-Champaign, <a href="mailto:kejc@illinois.edu" class="email">kejc@illinois.edu</a></p>
</div>
<div class="section level1">
<h1 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h1>
<ul>
<li><a href="#Overview">Overview</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#Input-files">Input files</a></li>
<li><a href="#Quick-Start">Quick Start</a></li>
<li>
<a href="#Output">Output</a> <br>
</li>
</ul>
</div>
<div class="section level1">
<h1 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h1>
<p><strong>chlorofluoroR</strong> is an <code>R</code> package that provides a pipeline for quick processing and plotting of CF imaging data for specific parameters. Here, we wish to include/overlap with copy number data (based on BAR tag) and BASTA selection. Get data analysed in less than 30 mins :)</p>
<p><br></p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>The latest version of the package can be install directly from this GitHub repo:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"KJeynesCupper/chlorofluoroR"</span>, ref <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span></code></pre></div>
<p>Load package into R library:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kjeynescupper.github.io/chlorofluoroR/">chlorofluoroR</a></span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level1">
<h1 id="input-files">Input files<a class="anchor" aria-label="anchor" href="#input-files"></a>
</h1>
<p>See examples of format of input files:</p>
<ol style="list-style-type: decimal">
<li>Plate layout</li>
<li>Copy number results</li>
<li>Data from FluorCam software (frames-numeric)</li>
<li>BASTA selection (smartsheets log)</li>
</ol>
</div>
<div class="section level1">
<h1 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h1>
<p><strong>chlorofluoroR</strong> utilizes 96-well plate data. This data can be inputted as a single dataframe or a list of dataframe (each representing an individual plate).</p>
<p>The output data from the FluorCam software requires some wrangling - we can help with that.</p>
<p><br></p>
<div class="section level2">
<h2 id="id_1-load-data-into-r">1. Load data into R<a class="anchor" aria-label="anchor" href="#id_1-load-data-into-r"></a>
</h2>
<p>First we must load our: - plate layouts - copy number results - Data from FluorCam software (frames-numeric) - BASTA selection</p>
<p>DO NOT RUN THIS CODE</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"CF_demodata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"layout"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"selection_results"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"copynumber"</span><span class="op">)</span></span>
<span><span class="va">output_location</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plate_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">CF_demodata</span><span class="op">)</span></span>
<span><span class="va">smartsheet</span> <span class="op">=</span> <span class="va">selection_results</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="id_2-computing-the-fvfm-and-psii-distribution">2. Computing the FvFm and PSII distribution<a class="anchor" aria-label="anchor" href="#id_2-computing-the-fvfm-and-psii-distribution"></a>
</h2>
<p>This function wrangles the raw data from the FluorCam software, and organises it into a nice excel spreadsheet. This excel doc will have separate sheets for the FvFm and PSII data - these will be specific for each plate.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">step_one</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/computeFvFm_PSII.html">computeFvFm_PSII</a></span><span class="op">(</span><span class="va">CF_demodata</span>, </span>
<span>                              <span class="va">plate_names</span>, </span>
<span>                              <span class="va">layout</span>, </span>
<span>                              <span class="va">smartsheet</span>,</span>
<span>                              <span class="va">copynumber</span>,</span>
<span>                              <span class="va">output_location</span><span class="op">)</span></span></code></pre></div>
<p>This will return a list of dataframes, where each plates has a dataframe for FvFm and PSII. And saves an excel file containing all data (chlorofluoro_dataset_1.xlsx)and pdf plot for the FvFm and PSII (chlorofluoro_plot_1.pdf). The plot is a line graph with SD at each timepoint for each plant sample. The colour of each sample is determined by the BASTA selection results, where green represents positive (ie. resistant) and red represents negative (ie. not resistant). The line type is determined by the copy number </p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="id_2-subset-for-specific-combinations">2. Subset for specific combinations<a class="anchor" aria-label="anchor" href="#id_2-subset-for-specific-combinations"></a>
</h2>
<p>We want to use this data to help us select for lines to carry to T2. So, here we will filter for these desired traits. For example, we will select for those with a copy number value of 4 and BASTA positive (ie. resistant).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"step_one"</span><span class="op">)</span></span>
<span><span class="va">step_two</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/subset_chlorofluoro.html">subset_chlorofluoro</a></span><span class="op">(</span><span class="va">step_one</span>, <span class="va">output_location</span><span class="op">)</span></span></code></pre></div>
<p>This outputs a plot and excel document in the same way as compute_chlorofluor() function. See output as files “chlorofluoro_plot_2.pdf” and “chlorofluoro_dataset_2.xlsx” <br></p>
</div>
<div class="section level2">
<h2 id="id_3-summarise-the-fvfm-and-psii-values-for-each-plant-line">3. Summarise the FvFm and PSII values for each plant line.<a class="anchor" aria-label="anchor" href="#id_3-summarise-the-fvfm-and-psii-values-for-each-plant-line"></a>
</h2>
<p>Instead of looking at the distribution of the FvFm or PSII over multiple light pulses across time, we can calculate a mean. Here we plot the mean for these variables as a bar plot with error bars representing SD. As before, the colour is determined by the BASTA selection result. Output is also saved as an excel document (one sheet per plate and variable). See output as files “chlorofluoro_plot_3.pdf” and “chlorofluoro_dataset_3.xlsx”</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"step_one"</span><span class="op">)</span></span>
<span><span class="va">step_three</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/summarise_chlorofluoro.html">summarise_chlorofluoro</a></span><span class="op">(</span><span class="va">step_one</span>, <span class="va">output_location</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
</div>
<div class="section level1">
<h1 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h1>
<p>Each of the three functions in this package outputs either an excel file or a pdf or BOTH!</p>
<p>At the end, you will likely have these files: - chlorofluoro_dataset_1.xlsx - chlorofluoro_dataset_2.xlsx - chlorofluoro_dataset_3.xlsx</p>
<ul>
<li>chlorofluoro_plot_1.pdf</li>
<li>chlorofluoro_plot_2.pdf</li>
<li>chlorofluoro_plot_3.pdf</li>
</ul>
<p>Here is breakdown of each.</p>
<p><strong>chlorofluoro_dataset_1.xlsx</strong> Contains the columns: - <code>Plant_ID</code> - <code>Replicate</code> - <code>Selection</code> - <code>Timepoint</code> - <code>Time</code> - <code>BAR_copy</code> - <code>FvFm</code> or <code>PhiPSII</code></p>
<p><strong>chlorofluoro_dataset_2.xlsx</strong> Contains the columns: - <code>plate</code> - <code>Plant_ID</code> - <code>Replicate</code> - <code>Selection</code> - <code>Timepoint</code> - <code>Time</code> - <code>BAR_copy</code> - <code>FvFm</code> or <code>PhiPSII</code></p>
<p><strong>chlorofluoro_dataset_3.xlsx</strong> Contains the columns: - <code>Plant_ID</code> - <code>techreps</code> - <code>Selection</code> - <code>FvFm_Mean</code> or <code>PSII_Mean</code> - <code>FvFm_SD</code> or <code>PSII_SD</code></p>
<p>Description of plots: - chlorofluoro_plot_1.pdf: Chlorophyll fluorescence parameters Fv/Fm and ΦPSII across genotypes and transgene copy number.Line plots depict changes in (left) the maximum quantum efficiency of PSII (Fv/Fm) and (right) the effective quantum yield of PSII (ΦPSII) over time (minutes). Each line represents the mean value for an individual plant (distinguished by color), grouped by Plant ID. Colors represent BASTA selection result (green/positive or red/negative). Line types denote transgene copy number (e.g., 0, 1, 2). Error bars represent the standard error of the mean (SEM) at each time point.</p>
<ul>
<li><p>chlorofluoro_plot_2.pdf:Chlorophyll fluorescence parameters Fv/Fm and ΦPSII across specific genotypes and/or transgene copy number. Line plots depict changes in the maximum quantum efficiency of PSII (Fv/Fm) and the effective quantum yield of PSII (ΦPSII) over time (minutes). Each line represents the mean value for an individual plant (distinguished by color), grouped by Plant ID. Colors represent BASTA selection result (green/positive or red/negative). Line types denote transgene copy number (e.g., 0, 1, 2). Error bars represent the standard error of the mean (SEM) at each time point.</p></li>
<li><p>chlorofluoro_plot_3.pdf:Summary of chlorophyll fluorescence parameters Fv/Fm and ΦPSII across individual plants.Bar plots show the mean values of (left) Fv/Fm (maximum quantum efficiency of PSII) and (right) ΦPSII for each plant. Each bar represents the average measurement for an individual plant, with error bars indicating the standard deviation (SD). Colors are assigned based on the selection marker results (green/positive or red/negative).</p></li>
</ul>
<p><br><em>Last updated:</em> 06-25-2025</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/KJeynesCupper/chlorofluoroR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/KJeynesCupper/chlorofluoroR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing chlorofluoroR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Katie Jeynes-Cupper <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0000-1350-1371" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Katie Jeynes-Cupper.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
